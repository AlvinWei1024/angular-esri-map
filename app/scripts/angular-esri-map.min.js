!function(e){"use strict";e.module("esri.map",[]).directive("esriMap",["$q","$timeout",function(e,t){function n(e,t){var n=e.$root.$$phase;"$apply"===n||"$digest"===n?e.$eval(t):e.$apply(t)}function r(e){return Math.max(Math.floor(e/2)-2,0)}return{restrict:"E",scope:{center:"=",zoom:"=",basemap:"@",load:"&",extentChange:"&"},compile:function(e,t){return e.removeAttr("id"),e.append("<div id="+t.id+"></div>"),function(){}},controller:["$scope","$element","$attrs",function(a,o,i){var c,u,l,s=e.defer(),d={};i.extent?d.extent=a[i.extent]:(a.center.lng&&a.center.lat?d.center=[a.center.lng,a.center.lat]:a.center&&(d.center=a.center),a.zoom&&(d.zoom=a.zoom)),a.basemap&&(d.basemap=a.basemap),require(["esri/map"],function(e){var o=new e(i.id,d);s.resolve(o),o.on("load",function(){i.load&&a.$apply(function(){a.load()(o)})}),a.$watch("basemap",function(e,t){o.loaded&&e!==t&&o.setBasemap(e)}),a.$watch("center.lng",function(e,n){var i=r(a.zoom);o.loaded&&e&&n&&e.toFixed(i)!==n.toFixed(i)&&a.center.lat&&(c&&t.cancel(c),l=e,c=t(function(){o.centerAt([l,u||a.center.lat]),l=null,u=null},500))}),a.$watch("center.lat",function(e,n){var i=r(a.zoom);o.loaded&&e&&n&&e.toFixed(i)!==n.toFixed(i)&&a.center.lng&&(c&&t.cancel(c),u=e,c=t(function(){o.centerAt([l||a.center.lng,u]),l=null,u=null},500))}),a.$watch("zoom",function(e,t){o.loaded&&e!==t&&o.setZoom(e)}),o.on("extent-change",function(e){n(a,function(){var t,n;a.zoom=o.getZoom(),n=r(a.zoom),o.geographicExtent&&(t=o.geographicExtent.getCenter(),a.center.lng.toFixed(n)!==t.x.toFixed(n)&&(a.center.lng=t.x),a.center.lat.toFixed(n)!==t.y.toFixed(n)&&(a.center.lat=t.y)),i.extentChange&&a.extentChange()(e)})}),a.$on("$destroy",function(){o.destroy()})}),this.getMap=function(){return s.promise},this.addLayer=function(e){return this.getMap().then(function(t){return t.addLayer(e)})},this.addLayerInfo=function(e){this.layerInfos?this.layerInfos.push(e):this.layerInfos=[e]},this.getLayerInfos=function(){return this.layerInfos}}]}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriFeatureLayer",["$q",function(e){return{restrict:"E",require:["esriFeatureLayer","^esriMap"],replace:!0,controller:["$scope","$element","$attrs",function(t,n,r){var a=e.defer();require(["esri/layers/FeatureLayer"],function(e){var t=new e(r.url);a.resolve(t)}),this.getLayer=function(){return a.promise}}],link:function(e,t,n,r){var a=r[0],o=r[1];a.getLayer().then(function(e){return o.addLayer(e),o.addLayerInfo({title:n.title||e.name,layer:e,hideLayers:n.hideLayers?n.hideLayers.split(","):void 0,defaultSymbol:n.defaultSymbol?JSON.parse(n.defaultSymbol):!0}),e})}}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriLegend",["$document","$q",function(t,n){return{priority:-10,scope:{},replace:!0,require:["^esriMap"],link:function(t,r,a,o){var i=o[0],c=a.targetId||a.id,u=n.defer();require(["esri/dijit/Legend","dijit/registry"],function(n,r){i.getMap().then(function(a){var o={map:a},l=i.getLayerInfos();l&&(o.layerInfos=l);var s=r.byId(c);s&&s.destroyRecursive(),s=new n(o,c),s.startup(),t.layers=s.layers,e.forEach(t.layers,function(e,n){t.$watch("layers["+n+"].renderer",function(){s.refresh()})}),u.resolve(s)})})}}}])}(angular);