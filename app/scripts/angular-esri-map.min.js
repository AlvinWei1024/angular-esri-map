!function(e){"use strict";e.module("esri.map",[]),e.module("esri.map").factory("esriLoader",["$q",function(e){return function(r){var t=e.defer();return require([r],function(e){e?t.resolve(e):t.reject("Couldn't load "+r)}),t.promise}}])}(angular),function(e){"use strict";e.module("esri.map").service("esriRegistry",["$q",function(e){var r={};return{_register:function(t,n){r[t]||(r[t]=e.defer());var i=r[t];return n.promise.then(function(e){return i.resolve(e),e},function(e){return i.reject(e),e}),function(){delete r[t]}},get:function(t){if(r[t])return r[t].promise;var n=e.defer();return r[t]=n,n.promise}}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriMap",["$q","$timeout","esriLoader","esriRegistry",function(e,r,t,n){return{restrict:"E",scope:{center:"=",zoom:"=",basemap:"@",load:"&",extentChange:"&"},compile:function(e,r){return e.removeAttr("id"),e.append("<div id="+r.id+"></div>"),function(){}},controller:["$scope","$element","$attrs",function(i,o,a){var s=e.defer();if(a.registerAs){var u=n._register(a.registerAs,s);i.$on("$destroy",u)}var c={};a.extent?c.extent=i[a.extent]:(i.center.lng&&i.center.lat?c.center=[i.center.lng,i.center.lat]:i.center&&(c.center=i.center),i.zoom&&(c.zoom=i.zoom)),i.basemap&&(c.basemap=i.basemap),t("esri/map").then(function(e){var t=new e(a.id,c);s.resolve(t),t.on("load",function(){a.load&&i.$apply(function(){i.load()(t)})}),i.$watch("basemap",function(e,r){t.loaded&&e!==r&&t.setBasemap(e)}),i.inEvent=!1,i.$watch(function(e){return[e.center.lng,e.center.lat,e.zoom].join(",")},function(e){i.inEvent||(i.inEvent=!0,e=e.split(","),t.centerAndZoom([e[0],e[1]],e[2]).then(function(){i.inEvent=!1}))}),t.on("extent-change",function(e){i.inEvent||(i.inEvent=!0,i.$apply(function(){var n=t.geographicExtent.getCenter();i.center.lng=n.x,i.center.lat=n.y,i.zoom=t.getZoom(),a.extentChange&&i.extentChange()(e),r(function(){i.inEvent=!1},0)}))}),i.$on("$destroy",function(){t.destroy()})}),this.getMap=function(){return s.promise},this.addLayer=function(e){return this.getMap().then(function(r){return r.addLayer(e)})},this.addLayerInfo=function(e){this.layerInfos?this.layerInfos.push(e):this.layerInfos=[e]},this.getLayerInfos=function(){return this.layerInfos}}]}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriFeatureLayer",["$q",function(e){return{restrict:"E",require:["esriFeatureLayer","^esriMap"],replace:!0,controller:["$scope","$element","$attrs",function(r,t,n){var i=e.defer();require(["esri/layers/FeatureLayer"],function(e){var r=new e(n.url);i.resolve(r)}),this.getLayer=function(){return i.promise}}],link:function(e,r,t,n){var i=n[0],o=n[1];i.getLayer().then(function(e){return o.addLayer(e),o.addLayerInfo({title:t.title||e.name,layer:e,hideLayers:t.hideLayers?t.hideLayers.split(","):void 0,defaultSymbol:t.defaultSymbol?JSON.parse(t.defaultSymbol):!0}),e})}}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriLegend",["$document","$q",function(r,t){return{priority:-10,scope:{},replace:!0,require:["^esriMap"],link:function(r,n,i,o){var a=o[0],s=i.targetId||i.id,u=t.defer();require(["esri/dijit/Legend","dijit/registry"],function(t,n){a.getMap().then(function(i){var o={map:i},c=a.getLayerInfos();c&&(o.layerInfos=c);var f=n.byId(s);f&&f.destroyRecursive(),f=new t(o,s),f.startup(),r.layers=f.layers,e.forEach(r.layers,function(e,t){r.$watch("layers["+t+"].renderer",function(){f.refresh()})}),u.resolve(f)})})}}}])}(angular);