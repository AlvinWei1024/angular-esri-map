!function(e){"use strict";e.module("esri.map",[]),e.module("esri.map").factory("esriLoader",["$q",function(e){return function(t){var n=e.defer();return require([t],function(e){e?n.resolve(e):n.reject("Couldn't load "+t)}),n.promise}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriMap",["$q","$timeout","esriLoader",function(e,t,n){return{restrict:"E",scope:{center:"=",zoom:"=",basemap:"@",load:"&",extentChange:"&"},compile:function(e,t){return e.removeAttr("id"),e.append("<div id="+t.id+"></div>"),function(){}},controller:["$scope","$element","$attrs",function(r,i,a){var o=e.defer(),u={};a.extent?u.extent=r[a.extent]:(r.center.lng&&r.center.lat?u.center=[r.center.lng,r.center.lat]:r.center&&(u.center=r.center),r.zoom&&(u.zoom=r.zoom)),r.basemap&&(u.basemap=r.basemap),n("esri/map").then(function(e){var n=new e(a.id,u);o.resolve(n),n.on("load",function(){a.load&&r.$apply(function(){r.load()(n)})}),r.$watch("basemap",function(e,t){n.loaded&&e!==t&&n.setBasemap(e)}),r.inEvent=!1,r.$watch(function(e){return[e.center.lng,e.center.lat,e.zoom].join(",")},function(e){r.inEvent||(r.inEvent=!0,e=e.split(","),n.centerAndZoom([e[0],e[1]],e[2]).then(function(){r.inEvent=!1}))}),n.on("extent-change",function(e){r.inEvent||(r.inEvent=!0,r.$apply(function(){var i=n.geographicExtent.getCenter();r.center.lng=i.x,r.center.lat=i.y,r.zoom=n.getZoom(),a.extentChange&&r.extentChange()(e),t(function(){r.inEvent=!1},0)}))}),r.$on("$destroy",function(){n.destroy()})}),this.getMap=function(){return o.promise},this.addLayer=function(e){return this.getMap().then(function(t){return t.addLayer(e)})},this.addLayerInfo=function(e){this.layerInfos?this.layerInfos.push(e):this.layerInfos=[e]},this.getLayerInfos=function(){return this.layerInfos}}]}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriFeatureLayer",["$q",function(e){return{restrict:"E",require:["esriFeatureLayer","^esriMap"],replace:!0,controller:["$scope","$element","$attrs",function(t,n,r){var i=e.defer();require(["esri/layers/FeatureLayer"],function(e){var t=new e(r.url);i.resolve(t)}),this.getLayer=function(){return i.promise}}],link:function(e,t,n,r){var i=r[0],a=r[1];i.getLayer().then(function(e){return a.addLayer(e),a.addLayerInfo({title:n.title||e.name,layer:e,hideLayers:n.hideLayers?n.hideLayers.split(","):void 0,defaultSymbol:n.defaultSymbol?JSON.parse(n.defaultSymbol):!0}),e})}}}])}(angular),function(e){"use strict";e.module("esri.map").directive("esriLegend",["$document","$q",function(t,n){return{priority:-10,scope:{},replace:!0,require:["^esriMap"],link:function(t,r,i,a){var o=a[0],u=i.targetId||i.id,s=n.defer();require(["esri/dijit/Legend","dijit/registry"],function(n,r){o.getMap().then(function(i){var a={map:i},c=o.getLayerInfos();c&&(a.layerInfos=c);var l=r.byId(u);l&&l.destroyRecursive(),l=new n(a,u),l.startup(),t.layers=l.layers,e.forEach(t.layers,function(e,n){t.$watch("layers["+n+"].renderer",function(){l.refresh()})}),s.resolve(l)})})}}}])}(angular);